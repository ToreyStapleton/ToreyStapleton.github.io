<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Battlefield 4</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" media="screen" href="style.css">
</head>
<body>
  <h1 class="header">Battlefield 4 Statistics</h1>
  <div class="container">
  </div>
  <div class="footer">
    Data provided by <a target="blank_" href="http://bf4stats.com/">bf4stats</a>
  </div>
<script>

window.onload = function () {
  xmlData();
};

const endpoint = 'http://api.bf4stats.com/api/onlinePlayers?output=json';
const onlinePlayers = [];

var oReq;

function xmlData() {
  oReq = new XMLHttpRequest();
  oReq.onreadystatechange = logContents;
  oReq.open('GET', endpoint);
  oReq.send();
};

function logContents() {
  oReq = JSON.parse(oReq.response);
  return getPlatformInfo();
};

// function getData() {
//   fetch(endpoint).then(function (data) {
//     data.json().then(function (data) {
//       onlinePlayers.push(data);
//       getPlatformInfo();
//     });
//   });
// };


function getPlatformInfo() {
    for(var key in oReq) {
      console.log(oReq[key])
      showPlatform(oReq[key].count, oReq[key].label, oReq[key].peak24)
    }
};

var container = document.querySelector('.container');

function showPlatform(count, label, peak24) {
  var line = document.createElement('div');
  line.setAttribute('class', 'platform');
  line.innerHTML = `
  <div class="label">${label}</div>
  <div class="count">Players Online: ${count}</div>
  <div class="peak24">Peak over last 24 hours: ${peak24}</div>
  `;
  container.appendChild(line);
}

</script>
  </body>
</html>
